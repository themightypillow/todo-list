(()=>{"use strict";const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"width","20"),e.setAttributeNS(null,"height","20"),e.setAttributeNS(null,"viewBox","0 0 24 24"),e.setAttributeNS(null,"stroke-width","1.5"),e.setAttributeNS(null,"fill","none"),e.setAttributeNS(null,"stroke-linecap","round"),e.setAttributeNS(null,"stroke-linejoin","round");const t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttributeNS(null,"stroke","none"),t.setAttributeNS(null,"d","M0 0h24v24H0z"),t.setAttributeNS(null,"fill","none"),e.appendChild(t);const n=e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","line");return t.setAttributeNS(null,"x1",e.x1),t.setAttributeNS(null,"y1",e.y1),t.setAttributeNS(null,"x2",e.x2),t.setAttributeNS(null,"y2",e.y2),t},o=e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","circle");return t.setAttributeNS(null,"cx",e.cx),t.setAttributeNS(null,"cy",e.cy),t.setAttributeNS(null,"r",e.r),t},c=e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttributeNS(null,"d",e),t},l=(()=>{const t=e.cloneNode(!0);return t.setAttributeNS(null,"stroke","#00aaff"),t.appendChild(n({x1:"9",y1:"6",x2:"20",y2:"6"})),t.appendChild(n({x1:"9",y1:"12",x2:"20",y2:"12"})),t.appendChild(n({x1:"9",y1:"18",x2:"20",y2:"18"})),t.appendChild(n({x1:"5",y1:"6",x2:"5",y2:"6.01"})),t.appendChild(n({x1:"5",y1:"12",x2:"5",y2:"12.01"})),t.appendChild(n({x1:"5",y1:"18",x2:"5",y2:"18.01"})),t})(),r=(()=>{const t=e.cloneNode(!0);return t.setAttributeNS(null,"stroke","#00aaff"),t.appendChild(n({x1:"12",y1:"5",x2:"12",y2:"19"})),t.appendChild(n({x1:"5",y1:"12",x2:"19",y2:"12"})),t})(),d=(()=>{const t=e.cloneNode(!0);return t.setAttributeNS(null,"stroke","#c8c8c8"),t.appendChild(o({cx:"12",cy:"12",r:"9"})),t})(),a=(d.cloneNode(!0).setAttributeNS(null,"stroke","#dc4c3f"),d.cloneNode(!0).appendChild(c("M9 12l2 2l4 -4")),(()=>{const t=e.cloneNode(!0);return t.setAttributeNS(null,"stroke","#dc4c3f"),t.appendChild(n({x1:"10",y1:"11",x2:"10",y2:"17"})),t.appendChild(n({x1:"14",y1:"11",x2:"14",y2:"17"})),t.appendChild(n({x1:"4",y1:"7",x2:"20",y2:"7"})),t.appendChild(c("M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12")),t.appendChild(c("M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3")),t})()),s=(()=>{const t=e.cloneNode(!0);return t.setAttributeNS(null,"stroke","#c8c8c8"),t.appendChild(c("M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4")),t.appendChild(o({cx:"18",cy:"18",r:"4"})),t.appendChild(c("M15 3v4")),t.appendChild(c("M7 3v4")),t.appendChild(c("M3 11h16")),t.appendChild(c("M18 16.496v1.504l1 1")),t})(),i=(()=>{const t=e.cloneNode(!0);return t.setAttributeNS(null,"stroke","#00aaff"),t.appendChild(c("M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3")),t.appendChild(c("M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3")),t.appendChild(n({x1:"16",y1:"5",x2:"19",y2:"8"})),t})(),u=(()=>{let e=[];const t=()=>{c(o("My Tasks")).store(),n()},n=()=>{localStorage.setItem("project-total",e.length)},o=t=>{const n=e.length,o=((e,t)=>{const n=[],o=()=>n.map((e=>e.info()));return{setName:t=>e=t,getName:()=>e,setId:e=>t=e,store:()=>{localStorage.setItem(`project-${t}`,JSON.stringify({name:e,tasks:o()}))},add:(e,t,o,c)=>n.push(((e,t,n,o)=>{let c=!1;return{toggleDone:()=>c=!c,togglePrio:()=>o=!o,setTitle:t=>e=t,setDesc:e=>t=e,setDue:e=>n=e,info:()=>({title:e,desc:t,due:n,prio:o})}})(e,t,o,c))-1,remove:e=>n.splice(e,1),all:o}})(t,n);return e.push(o),n},c=t=>e[t];return{store:n,load:()=>{if(0===localStorage.length)t();else if(localStorage.getItem("project-total")){const n=Number(localStorage.getItem("project-total"));if(Number.isInteger(n))for(let c=0;c<n;c++){if(!localStorage.getItem(`project-${c}`)){localStorage.clear(),e=[],t();break}const n=JSON.parse(localStorage.getItem(`project-${c}`)),l=o(n.name);n.tasks.forEach((t=>{e[l].add(t.title,t.desc,new Date(t.due),t.prio)}))}else localStorage.clear(),t()}},add:o,remove:t=>{localStorage.removeItem("project-"+(e.length-1)),e.splice(t,1),n(),e.forEach(((e,t)=>{e.setId(t),e.store()}))},at:c,names:()=>e.map((e=>e.getName()))}})();(()=>{const e=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},t=()=>({form:document.querySelector("#task-form"),title:document.querySelector("#new-task-title"),desc:document.querySelector("#new-task-desc"),due:document.querySelector("#new-task-due"),prio:document.querySelector("#new-task-prio"),cancel:document.querySelector("#cancel-task")}),n=n=>{n&&e(document.querySelector("#task-info"));const{form:o,title:c,desc:l,due:r,prio:d,cancel:a}=t();o.style.display="none",c.value="",l.value="",r.value="",d.checked=!1,a.disabled=!0,o.querySelector("h3").textContent="",document.querySelector("#cancel-task + button")&&o.querySelector("#task-buttons").removeChild(document.querySelector("#cancel-task + button"))},o=t=>{const n=document.createElement("div");n.classList.add("icon-label");const o=document.createElement("label");o.textContent=t.title,n.appendChild(d.cloneNode(!0)),n.appendChild(o);const c=document.querySelector("main");o.addEventListener("click",(n=>(t=>{const n=document.querySelector("#task-info");e(n);const o=document.createElement("div");o.appendChild(d.cloneNode(!0));const c=i.cloneNode(!0);c.addEventListener("click",(e=>{console.log("will edit")})),o.appendChild(c),n.appendChild(o);const l=document.createElement("h3");l.textContent=t.title,n.appendChild(l);const r=document.createElement("div");r.textContent=t.desc,n.appendChild(r);const a=document.createElement("div");a.classList.add("icon-label"),a.appendChild(s);const u=document.createElement("div");u.textContent=t.due.toDateString().replace(" ",", "),a.appendChild(u),n.appendChild(a)})(t)));const l=document.querySelector("main > .add");c.insertBefore(n,l)},c=()=>({container:document.querySelector("#project-form"),form:document.querySelector("#project-form > form"),name:document.querySelector("#new-project-name"),cancel:document.querySelector("#cancel-project")}),p=()=>{const{container:e,form:t,name:n,cancel:o}=c();n.value="",e.style.display="none",t.querySelector("h3").textContent="",o.disabled=!0,document.querySelector("#cancel-project + button")&&t.querySelector("#project-buttons").removeChild(document.querySelector("#cancel-project + button")),document.querySelector("#project-form-header > svg")&&document.querySelector("#project-form-header").removeChild(document.querySelector("#project-form-header > svg"))},m=(e,t)=>{const{form:n,cancel:o}=c();n.querySelector("h3").textContent=e?"Edit Project":"New Project",o.disabled=!1;const l=document.createElement("button");if(l.textContent="Ok",n.querySelector("#project-buttons").appendChild(l),e){const e=a.cloneNode(!0);e.addEventListener("click",(e=>{h(t),p()})),document.querySelector("#project-form-header").appendChild(e)}return l},h=t=>{const n=document.querySelector("main");if(document.querySelector("#projects").removeChild(t.parentElement),u.remove(t.dataset.index),document.querySelectorAll(".project").forEach(((e,t)=>{e.dataset.index=t})),n.dataset.index===t.dataset.index){e(n);const o=document.querySelector(`.project[data-index="${t.dataset.index}"]`);o&&S(o)}},y=e=>{const{container:t,form:n,name:o,cancel:l}=c(),r=m(!0,e),d=e.querySelector("h4");o.value=d.textContent,r.addEventListener("click",(t=>{t.preventDefault(),d.textContent=o.value,d.classList.contains("bold")&&(document.querySelector("#project-header > h2").textContent=o.value);const n=u.at(e.dataset.index);n.setName(o.value),n.store(),p()})),t.style.display="block"},S=c=>{var l;l=c.querySelector("h4"),document.querySelectorAll(".project > h4").forEach((e=>e.classList.remove("bold"))),l.classList.add("bold");const d=document.querySelector("main");d.dataset.index=c.dataset.index,e(d),e(document.querySelector("#task-info"));const a=document.createElement("div"),s=document.createElement("h2");s.textContent=c.textContent,a.appendChild(s);const p=i.cloneNode(!0);p.addEventListener("click",(e=>{const t=document.querySelector("main").dataset.index;y(document.querySelector(`.project[data-index="${t}"]`))})),a.appendChild(p),a.id="project-header",d.appendChild(a),u.at(c.dataset.index).all().forEach(((e,t)=>o({index:t,...e})));const m=document.createElement("div");m.classList.add("icon-label","add"),m.appendChild(r);const h=document.createElement("div");h.textContent="Add Task",m.appendChild(h),m.addEventListener("click",(e=>(e=>{const{form:c,title:l,desc:r,due:d,prio:a}=t();(e=>{const{form:n,cancel:o}=t();n.querySelector("h3").textContent="New Task",o.disabled=!1;const c=document.createElement("button");return c.textContent="Ok",n.querySelector("#task-buttons").appendChild(c),c})().addEventListener("click",(t=>{if(t.preventDefault(),l.value){const t=new Date(d.value?new Date(d.value.replaceAll("-","/")):new Date),n=u.at(e),c=n.add(l.value,r.value,t,a.checked);n.store(),o({index:c,title:l.value,desc:r.value,due:t,prio:a.checked})}n(!1)})),c.style.display="block"})(c.dataset.index))),d.appendChild(m)},v=(e,t)=>{const n=document.querySelector("#projects"),o=document.createElement("div");o.classList.add("icon-label","project"),o.appendChild(l.cloneNode(!0));const c=document.createElement("h4");c.textContent=e,o.appendChild(c),o.addEventListener("click",(e=>S(e.currentTarget))),o.dataset.index=t;const r=document.createElement("div");r.classList.add("project-sidebar"),r.appendChild(o);const d=i.cloneNode(!0);return d.classList.add("edit"),d.style.display="none",r.appendChild(d),d.addEventListener("click",(e=>{y(o)})),r.addEventListener("mouseover",(e=>{e.currentTarget.querySelector(".edit").style.display="block"})),r.addEventListener("mouseout",(e=>{e.currentTarget.querySelector(".edit").style.display="none"})),n.appendChild(r),o};u.load(),u.names().forEach(((e,t)=>v(e,t))),S(document.querySelector(".project")),document.querySelectorAll("form > input[type='text']").forEach((e=>{e.addEventListener("keypress",(e=>{"Enter"===e.key&&e.preventDefault()}))})),function(){const{container:e,name:t,cancel:n}=c();n.addEventListener("click",(e=>{e.preventDefault(),p()})),document.querySelector("#add-project").addEventListener("click",(n=>{m(!1).addEventListener("click",(e=>{e.preventDefault();const n=""===t.value?"Untitled":t.value,o=u.add(n);u.store(),u.at(o).store(),S(v(n,o)),p()})),e.style.display="block"}))}(),document.querySelector("#cancel-task").addEventListener("click",(e=>{e.preventDefault(),n()}))})()})();